<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>券商费率对比表</title>
    <style>
        @charset "utf-8";

        /* 防止用户自定义背景颜色对网页的影响，添加让用户可以自定义字体 */
        html {
            color: #333;
            background: #fff;
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
            text-rendering: optimizelegibility;
        }

        /* 如果你的项目仅支持 IE9+ | Chrome | Firefox 等，推荐在 <html> 中添加 .borderbox 这个 class */
        html.borderbox *,
        html.borderbox *:before,
        html.borderbox *:after {
            -moz-box-sizing: border-box;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
        }

        /* 内外边距通常让各个浏览器样式的表现位置不同 */
        body,
        dl,
        dt,
        dd,
        ul,
        ol,
        li,
        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        pre,
        code,
        form,
        fieldset,
        legend,
        input,
        textarea,
        p,
        blockquote,
        th,
        td,
        hr,
        button,
        article,
        aside,
        details,
        figcaption,
        figure,
        footer,
        header,
        menu,
        nav,
        section {
            margin: 0;
            padding: 0;
        }

        /* 重设 HTML5 标签, IE 需要在 js 中 createElement(TAG) */
        article,
        aside,
        details,
        figcaption,
        figure,
        footer,
        header,
        menu,
        nav,
        section {
            display: block;
        }

        /* HTML5 媒体文件跟 img 保持一致 */
        audio,
        canvas,
        video {
            display: inline-block;
        }

        /* 要注意表单元素并不继承父级 font 的问题 */
        body,
        button,
        input,
        select,
        textarea {
            font: 300 1em/1.8 PingFang SC, Lantinghei SC, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif;
        }

        button::-moz-focus-inner,
        input::-moz-focus-inner {
            padding: 0;
            border: 0;
        }

        /* 去掉各Table cell 的边距并让其边重合 */
        table {
            border-collapse: collapse;
            border-spacing: 0;
        }

        /* 去除默认边框 */
        fieldset,
        img {
            border: 0;
        }

        /* 块/段落引用 */
        blockquote {
            position: relative;
            color: #999;
            font-weight: 400;
            border-left: 1px solid #1abc9c;
            padding-left: 1em;
            margin: 1em 3em 1em 2em;
        }

        @media only screen and (max-width: 640px) {
            blockquote {
                margin: 1em 0;
            }
        }

        /* Firefox 以外，元素没有下划线，需添加 */
        acronym,
        abbr {
            border-bottom: 1px dotted;
            font-variant: normal;
            text-decoration: none;
        }

        /* 添加鼠标问号，进一步确保应用的语义是正确的（要知道，交互他们也有洁癖，如果你不去掉，那得多花点口舌） */
        abbr {
            cursor: help;
        }

        /* 一致的 del 样式 */
        del {
            text-decoration: line-through;
        }

        address,
        caption,
        cite,
        code,
        dfn,
        em,
        th,
        var {
            font-style: normal;
            font-weight: 400;
        }

        /* 去掉列表前的标识, li 会继承，大部分网站通常用列表来很多内容，所以应该当去 */
        ul,
        ol {
            list-style: none;
        }

        /* 对齐是排版最重要的因素, 别让什么都居中 */
        caption,
        th {
            text-align: left;
        }

        q:before,
        q:after {
            content: '';
        }

        /* 统一上标和下标 */
        sub,
        sup {
            font-size: 75%;
            line-height: 0;
            position: relative;
        }

        :root sub,
        :root sup {
            vertical-align: baseline;
            /* for ie9 and other modern browsers */
        }

        sup {
            top: -0.5em;
        }

        sub {
            bottom: -0.25em;
        }

        /* 让链接在 hover 状态下显示下划线 */
        a {
            color: #1abc9c;
        }

        a:hover {
            text-decoration: underline;
        }

        .typo a {
            border-bottom: 1px solid #1abc9c;
        }

        .typo a:hover {
            border-bottom-color: #555;
            color: #555;
            text-decoration: none;
        }

        /* 默认不显示下划线，保持页面简洁 */
        ins,
        a {
            text-decoration: none;
        }

        /* 专名号：虽然 u 已经重回 html5 Draft，但在所有浏览器中都是可以使用的，
 * 要做到更好，向后兼容的话，添加 class="typo-u" 来显示专名号
 * 关于 <u> 标签：http://www.whatwg.org/specs/web-apps/current-work/multipage/text-level-semantics.html#the-u-element
 * 被放弃的是 4，之前一直搞错 http://www.w3.org/TR/html401/appendix/changes.html#idx-deprecated
 * 一篇关于 <u> 标签的很好文章：http://html5doctor.com/u-element/
 */
        u,
        .typo-u {
            text-decoration: underline;
        }

        /* 标记，类似于手写的荧光笔的作用 */
        mark {
            background: #fffdd1;
            border-bottom: 1px solid #ffedce;
            padding: 2px;
            margin: 0 5px;
        }

        /* 代码片断 */
        pre,
        code,
        pre tt {
            font-family: Courier, 'Courier New', monospace;
        }

        pre {
            background: #f8f8f8;
            border: 1px solid #ddd;
            padding: 1em 1.5em;
            display: block;
            -webkit-overflow-scrolling: touch;
        }

        /* 一致化 horizontal rule */
        hr {
            border: none;
            border-bottom: 1px solid #cfcfcf;
            margin-bottom: 0.8em;
            height: 10px;
        }

        /* 底部印刷体、版本等标记 */
        small,
        .typo-small,
        /* 图片说明 */
        figcaption {
            font-size: 0.9em;
            color: #888;
        }

        strong,
        b {
            font-weight: bold;
            color: #000;
        }

        /* 可拖动文件添加拖动手势 */
        [draggable] {
            cursor: move;
        }

        .clearfix:before,
        .clearfix:after {
            content: "";
            display: table;
        }

        .clearfix:after {
            clear: both;
        }

        .clearfix {
            zoom: 1;
        }

        /* 强制文本换行 */
        .textwrap,
        .textwrap td,
        .textwrap th {
            word-wrap: break-word;
            word-break: break-all;
        }

        .textwrap-table {
            table-layout: fixed;
        }

        /* 提供 serif 版本的字体设置: iOS 下中文自动 fallback 到 sans-serif */
        .serif {
            font-family: Palatino, Optima, Georgia, serif;
        }

        /* 保证块/段落之间的空白隔行 */
        .typo p,
        .typo pre,
        .typo ul,
        .typo ol,
        .typo dl,
        .typo form,
        .typo hr,
        .typo table,
        .typo-p,
        .typo-pre,
        .typo-ul,
        .typo-ol,
        .typo-dl,
        .typo-form,
        .typo-hr,
        .typo-table,
        blockquote {
            margin-bottom: 1.2em
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: PingFang SC, Verdana, Helvetica Neue, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif;
            font-weight: 100;
            color: #000;
            line-height: 1.35;
        }

        /* 标题应该更贴紧内容，并与其他块区分，margin 值要相应做优化 */
        .typo h1,
        .typo h2,
        .typo h3,
        .typo h4,
        .typo h5,
        .typo h6,
        .typo-h1,
        .typo-h2,
        .typo-h3,
        .typo-h4,
        .typo-h5,
        .typo-h6 {
            margin-top: 1.2em;
            margin-bottom: 0.6em;
            line-height: 1.35;
        }

        .typo h1,
        .typo-h1 {
            font-size: 2em;
        }

        .typo h2,
        .typo-h2 {
            font-size: 1.8em;
        }

        .typo h3,
        .typo-h3 {
            font-size: 1.6em;
        }

        .typo h4,
        .typo-h4 {
            font-size: 1.4em;
        }

        .typo h5,
        .typo h6,
        .typo-h5,
        .typo-h6 {
            font-size: 1.2em;
        }

        /* 在文章中，应该还原 ul 和 ol 的样式 */
        .typo ul,
        .typo-ul {
            margin-left: 1.3em;
            list-style: disc;
        }

        .typo ol,
        .typo-ol {
            list-style: decimal;
            margin-left: 1.9em;
        }

        .typo li ul,
        .typo li ol,
        .typo-ul ul,
        .typo-ul ol,
        .typo-ol ul,
        .typo-ol ol {
            margin-bottom: 0.8em;
            margin-left: 2em;
        }

        .typo li ul,
        .typo-ul ul,
        .typo-ol ul {
            list-style: circle;
        }

        /* 同 ul/ol，在文章中应用 table 基本格式 */
        .typo table th,
        .typo table td,
        .typo-table th,
        .typo-table td,
        .typo table caption {
            border: 1px solid #ddd;
            padding: 0.5em 1em;
            color: #666;
        }

        .typo table th,
        .typo-table th {
            background: #fbfbfb;
        }

        .typo table thead th,
        .typo-table thead th {
            background: #f1f1f1;
        }

        .typo table caption {
            border-bottom: none;
        }

        /* 去除 webkit 中 input 和 textarea 的默认样式  */
        .typo-input,
        .typo-textarea {
            /* -webkit-appearance: none; */
            border-radius: 0;
        }

        .typo-em,
        .typo em,
        legend,
        caption {
            color: #000;
            font-weight: inherit;
        }

        /* 着重号，只能在少量（少于100个字符）且全是全角字符的情况下使用 */
        .typo-em {
            position: relative;
        }

        .typo-em:after {
            position: absolute;
            top: 0.65em;
            left: 0;
            width: 100%;
            overflow: hidden;
            white-space: nowrap;
            content: "・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・";
        }

        /* Responsive images */
        .typo img {
            max-width: 100%;
        }

        /* 全局样式 */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            line-height: 1.6;
            color: #222;
            background-color: #fff;
            font-size: 13px;
        }

        /* 容器布局 */
        .container {
            display: flex;
            min-height: 100vh;
        }

        /* 左侧控制面板 */
        .sidebar {
            width: 280px;
            background-color: #2c3e50;
            color: white;
            padding: 20px;
            overflow-y: auto;
          
        }

        .sidebar h2 {
            color: white;
            margin-bottom: 20px;
            border-bottom: 1px solid #34495e;
            padding-bottom: 10px;
        }

        .control-section {
            margin-bottom: 30px;
        }

        .control-title {
            font-weight: bold;
            margin-bottom: 15px;
            color: #ecf0f1;
        }

        /* 筛选器样式 */
        .filter-list {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 15px;
        }

        .filter-item {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .filter-item label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            color: #ecf0f1;
            font-size: 14px;
        }

        .filter-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
            cursor: pointer;
        }

        .high-end-badge {
            background-color: #e74c3c;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 5px;
        }

        /* 操作按钮 */
        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .action-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        .btn-success {
            background-color: #27ae60;
            color: white;
        }

        .btn-success:hover {
            background-color: #2ecc71;
        }

        .btn-danger {
            background-color: #e74c3c;
            color: white;
        }

        .btn-danger:hover {
            background-color: #c0392b;
        }

        .btn-secondary {
            background-color: #7f8c8d;
            color: white;
        }

        .btn-secondary:hover {
            background-color: #95a5a6;
        }

        /* 右侧内容区域 */
        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .main-content h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #2c3e50;
        }

        /* 表格容器 */
        .table-container {
            margin-bottom: 30px;
        }

        /* 表格样式 */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            font-size: 13px;
        }

        .data-table th {
            background-color: #333;
            color: rgb(245, 242, 242);
            font-weight: bold;
            text-align: left;
            padding: 5px 2px;
            white-space: nowrap;
        }

        .data-table td {
            padding: 5px 2px;
            border-bottom: 1px solid #ddd;
            vertical-align: middle;
        }

        .data-table td span {
            font-size: 0.8em;
            font-weight: 100;
            display: block;
            color: #666;
        }
        .data-table td:first-child {
            font-weight: bold;
        }
        
        /* 为倒数第二列单元格添加样式 */
        .data-table td:nth-last-child(2) {
            font-size: 0.8em;
        }
        
        /* 为最后一列单元格添加样式 */
        .data-table td:last-child {
            font-size: 0.8em;
        }

        .data-table tr:nth-child(even) {
            background-color: #fefefe;
        }

        .data-table tr:hover {
            background-color: #f1f1f1;
        }

        /* 特殊样式 */
        .recommend-cell {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 8px !important;
            color: #856404;
            font-weight: bold;
        }

        .no-data {
            text-align: center;
            padding: 40px !important;
            color: #7f8c8d;
            font-style: italic;
        }

        /* 页脚 */
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            text-align: center;
            color: #7f8c8d;
            font-size: 14px;
        }

        .footer p {
            margin-bottom: 8px;
        }

        /* 免责声明 */
        .disclaimer {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            margin-top: 30px;
            border-radius: 4px;
        }

        .disclaimer h3 {
            color: #495057;
            margin-bottom: 10px;
        }

        .disclaimer ul {
            padding-left: 20px;
        }
        @media screen and (max-width: 600px) {
            .data-table {
                border: 0;
            }

            .data-table caption {
                font-size: 1.2em;
            }

            .data-table thead {
                border: none;
                clip: rect(0 0 0 0);
                height: 1px;
                margin: -1px;
                overflow: hidden;
                padding: 0;
                position: absolute;
                width: 1px;
            }

            .data-table tr {
                border-bottom: 3px solid #ddd;
                display: block;
                margin-bottom: .625em;
            }

            .data-table td {
                border-bottom: 1px solid #ddd;
                display: block;
                font-size: 1.1em;
                text-align: left;
            }
            .data-table td span{
                display: inline;
            }

            .data-table td::before {
                /*
    * aria-label has no advantage, it won't be read inside a table
    content: attr(aria-label);
    */
                content: attr(data-label);
                float: left;
                padding-right: 20px;
                font-weight: bold;
                text-transform: uppercase;
            }

            .table td:last-child {
                border-bottom: 0;
            }
        }        

        /* 响应式设计
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                max-height: 300px;
                border-bottom: 2px solid #34495e;
            }

            .main-content {
                padding: 10px;
            }
        } */
    </style>
</head>

<body>
    <div class="container">
        <!-- 左侧控制面板 -->
        <div class="sidebar">
            <h2>控制面板</h2>

            <!-- 数据筛选 -->
            <div class="control-section">
                <div class="control-title">券商数据选择</div>
                <div class="filter-list" id="filterList">
                    <!-- 筛选项由JavaScript动态生成 -->
                </div>

                <!-- 操作按钮 -->
                <div class="action-buttons">
                    <button id="selectAllBtn" class="action-btn btn-success">全选</button>
                    <button id="deselectAllBtn" class="action-btn btn-danger">全不选</button>
                    <button id="resetBtn" class="action-btn btn-secondary">重置</button>
                </div>
            </div>
        </div>

        <!-- 右侧内容区域 -->
        <div class="main-content">

            <!-- 表格容器 -->
            <div class="table-container">
                <table id="dataTable" class="data-table">
                    <thead>
                        <tr>
                            <th style="min-width: 120px;">券商</th>
                            <th style="min-width: 40px;">门槛</th>
                            <th style="min-width: 80px;">股票</th>
                            <th style="min-width: 70px;">过户费</th>
                            <th style="min-width: 80px;">ETF</th>
                            <th style="min-width: 40px;">逆回购</th>
                            <th style="min-width: 100px;">可转债</th>
                            <th style="min-width: 70px;">港股通</th>
                            <th style="min-width: 70px;">北交所</th>
                            <!-- <th>两融</th> -->
                            <th style="min-width: 90px;">软件支持</th>
                            <th style="min-width: 100px;">永久费率要求</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <tr class="no-data" id="noDataRow">
                            <td colspan="16" class="no-data">请选择要显示的券商数据</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- 免责声明 -->
            <div class="disclaimer">
                <h3>免责声明</h3>
                <ul>
                    <li>投资有风险，入市需谨慎。</li>
                </ul>
            </div>

            <!-- 页脚 -->
            <div class="footer">
                <p>联系方式：304278785 (QQ) | netqqnet (wechat) | qing606@gmail.com</p>
                <p>&copy; 2025 老倔驴开户 - 专注于为散户朋友选择最优的股票费率方案</p>
            </div>
        </div>
    </div>

    <script>
        // 从单独的JSON文件中加载券商数据
        const brokerDataUrl = 'https://khm5.com/broker_data.json';
        let brokerData = [];

        // 异步加载JSON数据
        async function loadBrokerData() {
            try {
                // 尝试添加协议前缀，确保URL格式正确
                const url = new URL(brokerDataUrl, window.location.origin);
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                brokerData = await response.json();
                init(); // 数据加载完成后初始化页面
            } catch (error) {
                console.error('加载券商数据失败:', error);
                // 可以添加默认数据或错误提示逻辑，这里仅打印错误信息
            }
        }

        // 修改页面加载完成后的初始化逻辑
        if (window.addEventListener) {
            window.addEventListener('load', loadBrokerData, false);
        } else if (window.attachEvent) {
            window.attachEvent('onload', loadBrokerData);
        } else {
            window.onload = loadBrokerData;
        }


        // 2. 生成两位数序号
        function generateSerialNumber(broker) {
            const visibleData = brokerData.filter(b => b.visible);

            if (broker["是否高端"]) {
                const highEndData = visibleData.filter(b => b["是否高端"]);
                const index = highEndData.indexOf(broker);
                return String(10 + index).padStart(2, '0');
            } else {
                const normalData = visibleData.filter(b => !b["是否高端"]);
                const index = normalData.indexOf(broker);
                return String(1 + index).padStart(2, '0');
            }
        }

        // 3. 初始化筛选器 - 直接创建DOM元素
        function initFilters() {
            const filterList = document.getElementById('filterList');
            filterList.innerHTML = '';

            brokerData.forEach((broker, index) => {
                // 创建筛选器项
                const filterItem = document.createElement('div');
                filterItem.className = 'filter-item';

                // 创建复选框
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = 'broker-' + index;
                checkbox.dataset.index = index;
                checkbox.checked = broker.visible;

                // 创建标签
                const label = document.createElement('label');
                label.htmlFor = 'broker-' + index;

                // 创建文本节点
                const textNode = document.createTextNode(broker["券商代号"] + ' - ' + broker["券商"]);

                // 添加高端标签
                if (broker["是否高端"]) {
                    const highEndBadge = document.createElement('span');
                    highEndBadge.className = 'high-end-badge';
                    highEndBadge.textContent = 'H';
                    label.appendChild(textNode);
                    label.appendChild(highEndBadge);
                } else {
                    label.appendChild(textNode);
                }

                // 组装筛选器项
                filterItem.appendChild(checkbox);
                filterItem.appendChild(label);
                filterList.appendChild(filterItem);

                // 添加事件监听
                checkbox.addEventListener('change', function () {
                    const idx = parseInt(this.dataset.index);
                    brokerData[idx].visible = this.checked;
                    renderTable();
                });
            });
        }

        // 4. 设置批量操作按钮
        function setupBatchButtons() {
            // 全选
            document.getElementById('selectAllBtn').onclick = function () {
                brokerData.forEach(broker => {
                    broker.visible = true;
                });

                document.querySelectorAll('.filter-item input[type="checkbox"]').forEach(checkbox => {
                    checkbox.checked = true;
                });

                renderTable();
            };

            // 全不选
            document.getElementById('deselectAllBtn').onclick = function () {
                brokerData.forEach(broker => {
                    broker.visible = false;
                });

                document.querySelectorAll('.filter-item input[type="checkbox"]').forEach(checkbox => {
                    checkbox.checked = false;
                });

                renderTable();
            };

            // 重置
            document.getElementById('resetBtn').onclick = function () {
                brokerData.forEach(broker => {
                    broker.visible = true;
                });

                document.querySelectorAll('.filter-item input[type="checkbox"]').forEach(checkbox => {
                    checkbox.checked = true;
                });

                renderTable();
            };
        }

        // 5. 创建表格单元格
        function createTableCell(content, className = '') {
            const td = document.createElement('td');
            if (className) td.className = className;

            // 处理换行符
            if (content && typeof content === 'string' && content.includes('|')) {
                const lines = content.split('|');
                // 第一行内容直接添加到单元格
                td.textContent = lines[0];
                // 后续行内容添加到span中
                for (let i = 1; i < lines.length; i++) {
                    const span = document.createElement('span');
                    span.appendChild(document.createTextNode(lines[i]));
                    td.appendChild(span);
                }
            } else {
                td.textContent = content || '';
            }

            return td;
        }

        // 6. 渲染表格内容 - 完全使用原生DOM操作
        function renderTable() {
            const tableBody = document.getElementById('tableBody');
            const noDataRow = document.getElementById('noDataRow');

            // 清空表格
            tableBody.innerHTML = '';
            tableBody.appendChild(noDataRow);

            // 获取可见数据
            const visibleData = brokerData.filter(broker => broker.visible);

            // 如果没有数据，显示无数据提示
            if (visibleData.length === 0) {
                noDataRow.style.display = '';
                return;
            }

            // 隐藏无数据提示
            noDataRow.style.display = 'none';

            // 定义列对应的属性名，与表格列顺序一致
            const columnKeys = [
                "券商",
                "入金门槛",
                "股票",
                "过户费",
                "ETF",
                "逆回购",
                "可转债",
                "港股通",
                "北交所",
                "软件支持",
                "永久费率要求"
            ];

            // 渲染每一行数据
            visibleData.forEach(broker => {
                // 创建行
                const row = document.createElement('tr');

                // 生成序号
                const serialNumber = generateSerialNumber(broker);

                // 定义需要渲染的列数据
                const columns = [
                    {
                        value: () => {
                            // 获取URL参数
                            const urlParams = new URLSearchParams(window.location.search);
                            const showBrokerName = urlParams.get('s') === 'true';
                            
                            // 合并券商展示信息
                            let brokerInfo = serialNumber;
                            if (broker["券商代号"]) brokerInfo += " " + broker["券商代号"];
                            if (showBrokerName && broker["券商"]) brokerInfo += broker["券商"];

                            // 创建包含券商信息的单元格
                            const brokerCell = createTableCell('');
                            const brokerText = document.createTextNode(brokerInfo);
                            brokerCell.appendChild(brokerText);
                            if (broker["推荐语"]) {
                                const moreInfoSpan = document.createElement('span');
                                moreInfoSpan.className = 'moreinfo';
                                moreInfoSpan.textContent = broker["推荐语"];
                                brokerCell.appendChild(moreInfoSpan);
                            }
                            return brokerCell;
                        }
                    },
                    { value: () => broker["入金门槛"] },
                    { value: () => broker["股票"] },
                    { value: () => broker["过户费"] },
                    { value: () => broker["ETF"] },
                    { value: () => broker["逆回购"] },
                    { value: () => broker["可转债"] },
                    { value: () => broker["港股通"] },
                    { value: () => broker["北交所"] },
                    // { value: () => broker["两融"] },
                    {
                        value: () => {
                            // 假设软件支持信息存储在 broker["软件支持"] 对象中，对象格式如 { "同花顺": "电脑和手机", "通达信": "仅手机", "雪球": "" }
                            const softwareSupportObj = broker["软件支持"] || {};
                            return Object.entries(softwareSupportObj)
                                .map(([software, support]) => {
                                    if (support) {
                                        return `${software} ${support}`;
                                    }
                                    return software;
                                })
                                .join('\n');
                        }
                    },
                    { value: () => broker["永久费率要求"] }
                ];

                // 遍历列数据，创建单元格并添加到行
                columns.forEach((column, index) => {
                    const value = column.value();
                    let cell;
                    if (value instanceof HTMLElement) {
                        cell = value;
                    } else {
                        cell = createTableCell(value);
                    }
                    // 为单元格添加 data-label 属性
                    cell.setAttribute('data-label', columnKeys[index]);
                    row.appendChild(cell);
                });

                // 添加行到表格
                tableBody.appendChild(row);
            });
        }

        // 7. 初始化函数
        function init() {
            try {
                initFilters();
                setupBatchButtons();
                renderTable();
            } catch (e) {
                console.error('初始化错误:', e);
            }
        }

        // 页面加载完成后初始化
        if (window.addEventListener) {
            window.addEventListener('load', init, false);
        } else if (window.attachEvent) {
            window.attachEvent('onload', init);
        } else {
            window.onload = init;
        }
    </script>
</body>

</html>